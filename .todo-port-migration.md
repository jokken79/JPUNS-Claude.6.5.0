# Port Migration for JPUNS-Claude 6.5.0 - Todo List

## Status: In Progress
## Created: 2025-11-23
## Purpose: Reconfigure all application ports to avoid Docker conflicts

---

## Port Mapping Reference
- Frontend: 3000 → 3100
- Backend API: 8000 → 8100
- PostgreSQL: 5432 → 5532 (expose externally)
- Redis: 6379 → 6479 (expose externally)
- Adminer: 8080 → 8180
- Prometheus: 9090 → 9190
- Grafana: 3001 → 3101
- Nginx: 80 → 80 (unchanged), 443 → 443 (unchanged)
- OpenTelemetry: 4317 → 4417, 4318 → 4418
- Tempo: 3200 → 3300

---

## Tasks

### Phase 1: Docker Configuration
- [ ] 1.1: Update docker-compose.yml - Frontend service ports (3000 → 3100)
- [ ] 1.2: Update docker-compose.yml - Backend service ports (add 8000 → 8100 mapping)
- [ ] 1.3: Update docker-compose.yml - PostgreSQL expose to ports (add 5432 → 5532 mapping)
- [ ] 1.4: Update docker-compose.yml - Redis expose to ports (add 6379 → 6479 mapping)
- [ ] 1.5: Update docker-compose.yml - Adminer ports (8080 → 8180)
- [ ] 1.6: Update docker-compose.yml - Prometheus ports (9090 → 9190)
- [ ] 1.7: Update docker-compose.yml - Grafana ports (3001 → 3101)
- [ ] 1.8: Update docker-compose.yml - OpenTelemetry ports (4317 → 4417, 4318 → 4418)
- [ ] 1.9: Update docker-compose.yml - Tempo ports (3200 → 3300)
- [ ] 1.10: Update docker-compose.yml - Environment variables (FRONTEND_URL, API_URL references)

### Phase 2: Environment Files
- [ ] 2.1: Update .env.example - Add port configuration section
- [ ] 2.2: Update .env.example - FRONTEND_URL to http://localhost:3100
- [ ] 2.3: Update .env.example - Document PostgreSQL port 5532
- [ ] 2.4: Update .env.example - Document Redis port 6479
- [ ] 2.5: Update .env.example - Add all new port mappings with comments
- [ ] 2.6: Update backend/.env.example - FRONTEND_URL to http://localhost:3100
- [ ] 2.7: Update backend/.env.example - BACKEND_CORS_ORIGINS with new port
- [ ] 2.8: Update backend/.env.example - DATABASE_URL if needed

### Phase 3: Backend Configuration
- [ ] 3.1: Review backend/app/core/config.py for hardcoded ports
- [ ] 3.2: Update backend/app/core/config.py if any port references found
- [ ] 3.3: Search for port 3000 references in backend code
- [ ] 3.4: Search for port 8000 references in backend code
- [ ] 3.5: Update any found references

### Phase 4: Frontend Configuration
- [ ] 4.1: Update frontend/next.config.ts - API URL references
- [ ] 4.2: Search for hardcoded port references in frontend code
- [ ] 4.3: Create frontend/.env.local.example if doesn't exist
- [ ] 4.4: Add NEXT_PUBLIC_API_URL with port 8100
- [ ] 4.5: Update any frontend environment variable references

### Phase 5: Documentation
- [ ] 5.1: Create PORT_CONFIGURATION_6.5.0.md with complete port mapping
- [ ] 5.2: Add migration guide to PORT_CONFIGURATION_6.5.0.md
- [ ] 5.3: Add troubleshooting section to PORT_CONFIGURATION_6.5.0.md
- [ ] 5.4: Add verification commands to PORT_CONFIGURATION_6.5.0.md
- [ ] 5.5: Update README.md - Service URLs table
- [ ] 5.6: Update README.md - Quick Start section
- [ ] 5.7: Update README.md - Health check examples
- [ ] 5.8: Update README.md - Access instructions
- [ ] 5.9: Update README.md - curl command examples

### Phase 6: Additional Files Check
- [ ] 6.1: Search for port references in docker/ directory
- [ ] 6.2: Search for port references in scripts/ directory
- [ ] 6.3: Update nginx configuration if needed
- [ ] 6.4: Update observability configs if needed
- [ ] 6.5: Check deployment guides for port references

### Phase 7: Verification
- [ ] 7.1: Verify all docker-compose.yml changes are consistent
- [ ] 7.2: Verify all .env.example files are updated
- [ ] 7.3: Verify all documentation is updated
- [ ] 7.4: Create verification script for port availability
- [ ] 7.5: Test docker-compose up with new ports
- [ ] 7.6: Verify all services are accessible on new ports

---

## Notes
- Internal Docker network communication remains unchanged (services communicate on original ports internally)
- Only external port mappings (host → container) are changed
- Database and Redis are now exposed externally for development convenience
- All documentation must reflect new ports
- FRONTEND_URL is critical for CORS configuration

---

## Completion Criteria
- All services start successfully on new ports
- No port conflicts with other Docker applications
- All documentation updated
- Migration guide created
- All health checks pass
- Frontend can communicate with backend on new ports
